{
  "resourceType": "Bundle",
  "type": "transaction",
  "entry": [
    {
      "resource": {
        "resourceType": "PlanDefinition",
        "id": "ImmunizationReviewPlanDefinition",
        "status": "active",
        "type": "workflow-definition",
        "contained": [
          {
            "resourceType": "Bundle",
            "type": "transaction",
            "entry": [
              {
                "resource": {
                  "resourceType": "ActivityDefinition",
                  "id": "Activity-ImmunizationReview",
                  "url": "http://localhost/ActivityDefinition/Activity-ImmunizationReview",
                  "kind": "Task",
                  "relatedArtifact": {
                    "code": "depends-on",
                    "resource": "Questionnaire/Questionnaire-IMMZD1ClientHistory"
                  },
                  "library": [
                    "http://localhost/Library/immunizationreview|1.0.0"
                  ],
                  "dynamicValue": [
                    {
                      "path": "focus",
                      "expression": {
                        "language": "text/cql.identifier",
                        "expression": "Get Immunization Review Questionnaire Reference"
                      }
                    },
                    {
                      "path": "description",
                      "expression": {
                        "language": "text/cql.identifier",
                        "expression": "Get Immunization Review Description"
                      }
                    },
                    {
                      "path": "for",
                      "expression": {
                        "language": "text/cql.identifier",
                        "expression": "Get Patient Reference"
                      }
                    }
                  ]
                },
                "request": {
                  "method": "PUT",
                  "url": "ActivityDefinition/Activity-ImmunizationReview"
                }
              },
              {
                "resource": {
                  "resourceType": "Library",
                  "id": "immunizationreview",
                  "extension": [],
                  "url": "http://localhost/Library/immunizationreview|1.0.0",
                  "version": "1.0.0",
                  "name": "immunizationreview",
                  "relatedArtifact": [
                    {
                      "type": "depends-on",
                      "display": "FHIR model information",
                      "resource": "http://fhir.org/guides/cqf/common/Library/FHIR-ModelInfo|4.0.1"
                    },
                    {
                      "type": "depends-on",
                      "display": "Library FHIRHelpers",
                      "resource": "http://aphl.org/fhir/ecr/Library/FHIRHelpers|4.0.1"
                    }
                  ],
                  "content": [
                    {
                      "contentType": "text/cql",
                      "data": "bGlicmFyeSBpbW11bml6YXRpb25yZXZpZXcgdmVyc2lvbiAnMS4wLjAnCnVzaW5nIEZISVIgdmVyc2lvbiAnNC4wLjEnCmluY2x1ZGUgRkhJUkhlbHBlcnMgdmVyc2lvbiAnNC4wLjEnCgpkZWZpbmUgIkdldCBUYXNrIERlYWRsaW5lIjogVG9EYXRlKE5vdygpICsgMSB5ZWFyKQoKY29udGV4dCBQYXRpZW50CgovLyBQYXRpZW50IE9wZXJhdGlvbnMKZGVmaW5lICJHZXQgUGF0aWVudCBSZWZlcmVuY2UiOiBSZWZlcmVuY2UgewogIHJlZmVyZW5jZTogc3RyaW5nIHsgdmFsdWU6ICdQYXRpZW50LycgKyBQYXRpZW50LmlkfQp9CgoKLy8gSW1tdW5pemF0aW9uIFJldmlldyBTY3JlZW5pbmcKZGVmaW5lICJHZXQgSW1tdW5pemF0aW9uIFJldmlldyBEZXNjcmlwdGlvbiI6ICdJbW11bml6YXRpb24gUmV2aWV3JwpkZWZpbmUgIkdldCBJbW11bml6YXRpb24gUmV2aWV3IFF1ZXN0aW9ubmFpcmUgUmVmZXJlbmNlIjogUmVmZXJlbmNlIHsKICByZWZlcmVuY2U6IHN0cmluZyB7IHZhbHVlOiAnUXVlc3Rpb25uYWlyZS9RdWVzdGlvbm5haXJlLUlNTVpEMUNsaWVudEhpc3RvcnknfQp9CmRlZmluZSAiRWxpZ2libGUgZm9yIEltbXVuaXphdGlvbiBSZXZpZXciOiB0cnVlCg=="
                    }
                  ]
                },
                "request": {
                  "method": "PUT",
                  "url": "Library/immunizationeview"
                }
              }
            ]
          }
        ],
        "library": [
          "http://localhost/Library/immunizationreview|1.0.0"
        ],
        "action": [
          {
            "title": "Administer immunization review questionnaire",
            "definitionCanonical": "http://localhost/ActivityDefinition/Activity-ImmunizationReview",
            "condition": [
              {
                "kind": "applicability",
                "expression": {
                  "description": "Patient registration complete",
                  "language": "text/cql.identifier",
                  "expression": "Eligible for Immunization Review"
                }
              }
            ]
          }
        ]
      },
      "request": {
        "method": "PUT",
        "url": "PlanDefinition/ImmunizationReviewPlanDefinition"
      }
    },
    {
      "resource": {
        "resourceType": "ActivityDefinition",
        "id": "Activity-ImmunizationReview",
        "url": "http://localhost/ActivityDefinition/Activity-ImmunizationReview",
        "kind": "Task",
        "relatedArtifact": {
          "code": "depends-on",
          "resource": "Questionnaire/Questionnaire-IMMZD1ClientHistory"
        },
        "library": [
          "http://localhost/Library/immunizationreview|1.0.0"
        ],
        "dynamicValue": [
          {
            "path": "focus",
            "expression": {
              "language": "text/cql.identifier",
              "expression": "Get Immunization Review Questionnaire Reference"
            }
          },
          {
            "path": "description",
            "expression": {
              "language": "text/cql.identifier",
              "expression": "Get Immunization Review Description"
            }
          },
          {
            "path": "for",
            "expression": {
              "language": "text/cql.identifier",
              "expression": "Get Patient Reference"
            }
          }
        ]
      },
      "request": {
        "method": "PUT",
        "url": "ActivityDefinition/Activity-ImmunizationReview"
      }
    },
    {
      "resource": {
        "resourceType": "Library",
        "id": "immunizationreview",
        "extension": [],
        "url": "http://localhost/Library/immunizationreview|1.0.0",
        "version": "1.0.0",
        "name": "immunizationreview",
        "relatedArtifact": [
          {
            "type": "depends-on",
            "display": "FHIR model information",
            "resource": "http://fhir.org/guides/cqf/common/Library/FHIR-ModelInfo|4.0.1"
          },
          {
            "type": "depends-on",
            "display": "Library FHIRHelpers",
            "resource": "http://aphl.org/fhir/ecr/Library/FHIRHelpers|4.0.1"
          }
        ],
        "content": [
          {
            "contentType": "text/cql",
            "data": "bGlicmFyeSBpbW11bml6YXRpb25yZXZpZXcgdmVyc2lvbiAnMS4wLjAnCnVzaW5nIEZISVIgdmVyc2lvbiAnNC4wLjEnCmluY2x1ZGUgRkhJUkhlbHBlcnMgdmVyc2lvbiAnNC4wLjEnCgpkZWZpbmUgIkdldCBUYXNrIERlYWRsaW5lIjogVG9EYXRlKE5vdygpICsgMSB5ZWFyKQoKY29udGV4dCBQYXRpZW50CgovLyBQYXRpZW50IE9wZXJhdGlvbnMKZGVmaW5lICJHZXQgUGF0aWVudCBSZWZlcmVuY2UiOiBSZWZlcmVuY2UgewogIHJlZmVyZW5jZTogc3RyaW5nIHsgdmFsdWU6ICdQYXRpZW50LycgKyBQYXRpZW50LmlkfQp9CgoKLy8gSW1tdW5pemF0aW9uIFJldmlldyBTY3JlZW5pbmcKZGVmaW5lICJHZXQgSW1tdW5pemF0aW9uIFJldmlldyBEZXNjcmlwdGlvbiI6ICdJbW11bml6YXRpb24gUmV2aWV3JwpkZWZpbmUgIkdldCBJbW11bml6YXRpb24gUmV2aWV3IFF1ZXN0aW9ubmFpcmUgUmVmZXJlbmNlIjogUmVmZXJlbmNlIHsKICByZWZlcmVuY2U6IHN0cmluZyB7IHZhbHVlOiAnUXVlc3Rpb25uYWlyZS9RdWVzdGlvbm5haXJlLUlNTVpEMUNsaWVudEhpc3RvcnknfQp9CmRlZmluZSAiRWxpZ2libGUgZm9yIEltbXVuaXphdGlvbiBSZXZpZXciOiB0cnVlCg=="
          }
        ]
      },
      "request": {
        "method": "PUT",
        "url": "Library/immunizationeview"
      }
    }
  ]
}